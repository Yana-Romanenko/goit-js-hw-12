{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('.search-form');\nconst searchInput = document.querySelector('.picture-search-name');\nconst loader = document.querySelector('.loader-container');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more-button');\n\n\n const lightbox = new SimpleLightbox('.gallery a', {\n        captionDelay: 250,\n        captionsData: 'alt',\n        close: true,\n      });\n\nconst API_KEY = '41764451-f0ee5e8d00846e21c9f97a054';\n\nlet currentPage = 1;\nlet currentQuery = \"\"; \nlet totalHits = 0;\nlet cardHeight = 0; \n\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\n    searchForm.addEventListener('submit', async(event) => {\n      event.preventDefault();\n      loadMoreBtn.style.display = \"none\";\n       currentPage = 1;\n       gallery.innerHTML = \"\";\n\n  const query = searchInput.value.trim();\n          if (!query) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Please, enter something!',\n          position: 'topRight',\n        });\n        return;\n          }\n  \n      \n      currentQuery = query;\n      showLoader();\n      loader.textContent = \"Loading images, please wait...\";\n\n      \n      try {\n    const response = await axios.get(`https://pixabay.com/api/`, {\n        params: {\n            key: API_KEY,\n            q: currentQuery,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page: currentPage,\n            per_page: 40,\n        }\n    });\n    \n        const data = response.data;\n        hideLoader();\n     \n    if (data.hits && data.hits.length > 0) {\n        totalHits = data.totalHits; \n        const images = data.hits.map((hit) => ({\n            url: hit.webformatURL,\n            alt: hit.tags,\n            largeUrl: hit.largeImageURL,\n            likes: hit.likes,\n            views: hit.views,\n            comments: hit.comments,\n            downloads: hit.downloads,\n        }));\n\n      updateGallery(images);\n    \n    } else {\n    iziToast.info({\n        title: \"Info\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n      position: \"topRight\",\n    });\n}\n} catch (error) {\n    iziToast.error({\n      title: \"Error\",\n      message: \"An error occurred while fetching data. Please try again later.\",\n      position: \"topRight\",\n    });\n      } finally {\n        loader.textContent = \"\";\n        hideLoader();\n       \n    toggleLoadMoreButton();\n  };\n    });\n\n\n\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n   const firstCard = createGalleryCard(images[0]);\n      gallery.appendChild(firstCard);\n  cardHeight = document.querySelector('img').getBoundingClientRect().height;\n  updateGallery(images);\n   window.scrollBy({\n      top: cardHeight * 2, \n      behavior: 'smooth',\n    });\n  loader.textContent = \"Loading images, please wait...\";\n  showLoader();\n\ntry {\n  const response = await axios.get(`https://pixabay.com/api/`, {\n      params: {\n        key: API_KEY,\n        q: currentQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: currentPage,\n        per_page: 40,\n      },\n    });\n\n  const data = response.data;\n  hideLoader();\n\n    if (data.hits && data.hits.length > 0) {\n      totalHits = data.totalHits; \n        const images = data.hits.map((hit) => ({\n        url: hit.webformatURL,\n        alt: hit.tags,\n        largeUrl: hit.largeImageURL,\n        likes: hit.likes,\n        views: hit.views,\n        comments: hit.comments,\n        downloads: hit.downloads,\n      }));\n\n      updateGallery(images);\n      lightbox.refresh();\n    } else {\n      iziToast.info({\n        title: \"Info\",\n        message: \"No more images to load.\",\n        position: \"topRight\",\n      });\n    }\n  }  catch (error) {\n  iziToast.error({\n    title: \"Error\",\n    message: \"An error occurred while fetching data. Please try again later.\",\n    position: \"topRight\",\n  });\n} finally {\n  loader.textContent = \"\";\n  hideLoader(); \n}\n  \n  toggleLoadMoreButton();\n  }\n);\n\n \n\nfunction updateGallery(images) {\n  const galleryMarkup = images.reduce((html, image) => html + `\n<div class=\"gallery-item\">\n      <img src=\"${image.largeImageURL}\" alt=\"${image.tags}\">\n      <div class=\"image-info\">\n        <div class=\"img-info-item\">\n          <p>Likes:</p>\n          <p>${image.likes}</p>\n        </div>\n        <div class=\"img-info-item\">\n          <p>Views: </p>\n          <p>${image.views}</p>\n        </div>\n        <div class=\"img-info-item\">\n          <p>Comments: </p>\n          <p>${image.comments}</p>\n        </div>\n        <div class=\"img-info-item\">\n          <p>Downloads: </p>\n          <p>${image.downloads}</p>\n        </div>\n      </div>\n    </div>`, '');\n  gallery.insertAdjacentHTML('beforeend', galleryMarkup); \n  lightbox.refresh();\n}\n\n\nfunction toggleLoadMoreButton() {\n  if (totalHits > gallery.children.length) {\n   loadMoreBtn.style.display = \"block\";\n  } else {\n    loadMoreBtn.style.display = \"none\";\n    if (gallery.children.length > 0 && currentPage > 1 && totalHits === gallery.children.length) {\n      iziToast.info({\n        title: \"Info\",\n        message: \"We're sorry, but you've reached the end of search results\",\n        position: \"topRight\",\n      });\n    }\n  }\n}\n\nfunction createGalleryCard(image) {\n  const card = document.createElement(\"div\");\n  card.classList.add(\"gallery-card\");\n\n  const img = document.createElement(\"img\");\n  img.src = image.url;\n  img.alt = image.alt;\n\n  card.appendChild(img);\n  return card;\n}"],"names":["searchForm","searchInput","loader","gallery","loadMoreBtn","lightbox","SimpleLightbox","API_KEY","currentPage","currentQuery","totalHits","cardHeight","showLoader","hideLoader","event","query","iziToast","data","axios","images","hit","updateGallery","toggleLoadMoreButton","firstCard","createGalleryCard","galleryMarkup","html","image","card","img"],"mappings":"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"}